{% extends 'layouts/logged_in.twig' %}

{% block page_content %}

<div class="align-items-center d-md-flex justify-content-between">
  <h1 class="h2 mb-4">
    {{title}}
  </h1>
  {{ include('shared/_search_form.twig') }}
</div>

{% if isadmin != 0 %}
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav col-12">
        <a class="nav-link active col" href="{{site_url}}/adminusers">Users</a>
        <a class="nav-link col" href="{{site_url}}/adminevents">Events</a>
        <a class="nav-link col" href="{{site_url}}/admininfo">Info</a>
        <a class="hidden col-4"></a>
      </div>
    </div>
  </nav>
  <div class="row">
    <div class="col">
      <div class="tab-content pt-3">
        <div class="tab-pane fade show active" id="users" role="tabpanel" aria-labelledby="users-tab">
          <table class="table">
            <thead>
              <tr class="d-flex">
                <th class="col-1">ID</th>
                <th class="col">ONID</th>
                <th class="col">Name</th>
                <th class="col">Email</th>
                <th class="col-1"></th>
              </tr>
            </thead>
            <tbody>
              {% for key, user in users %}
                <tr class="d-flex">
                  <td class="col-1">
                    {{user['id']}}
                  </td>
                  <td class="col">
                    {{user['onid']}}
                  </td>
                  <td class="col">
                    {{user['last_name'] ~ ", " ~ user['first_name']}}
                  </td>
                  <td class="col">
                    {{user['email']}}
                  </td>
                  <td class="col-1">
                    <form method="post">
                      <input type="hidden" name="makeAdmin" value="1">
                      <input type="hidden" name="userId" value="{{user['id']}}">
                      <button class="btn btn-{% if userIsAdmin[key] == true %}secondary{% else %}primary{% endif %}">
                        Make Admin
                      </button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
{% else %}
  <p>You do not have access to this page.</p>
{% endif %}

{% endblock %}
